import yahooFinance from "yahoo-finance2";
import moment from "moment";
import { NextResponse } from "next/server";


const result = [
  {
    date: "2025-05-01T13:30:00.000Z",
    high: 290.8699951171875,
    volume: 99659000,
    open: 280.010009765625,
    low: 279.80999755859375,
    close: 280.5199890136719,
    adjClose: 280.5199890136719,
  },
  {
    date: "2025-05-02T13:30:00.000Z",
    high: 294.7799987792969,
    volume: 114454700,
    open: 284.8999938964844,
    low: 279.80999755859375,
    close: 287.2099914550781,
    adjClose: 287.2099914550781,
  },
  {
    date: "2025-05-05T13:30:00.000Z",
    high: 284.8500061035156,
    volume: 94618900,
    open: 284.57000732421875,
    low: 274.3999938964844,
    close: 280.260009765625,
    adjClose: 280.260009765625,
  },
  {
    date: "2025-05-06T13:30:00.000Z",
    high: 277.7300109863281,
    volume: 76715800,
    open: 273.1099853515625,
    low: 271.3500061035156,
    close: 275.3500061035156,
    adjClose: 275.3500061035156,
  },
  {
    date: "2025-05-07T13:30:00.000Z",
    high: 277.9200134277344,
    volume: 71592600,
    open: 276.8800048828125,
    low: 271,
    close: 276.2200012207031,
    adjClose: 276.2200012207031,
  },
  {
    date: "2025-05-08T13:30:00.000Z",
    high: 289.79998779296875,
    volume: 97539400,
    open: 279.6300048828125,
    low: 279.4100036621094,
    close: 284.82000732421875,
    adjClose: 284.82000732421875,
  },
  {
    date: "2025-05-09T13:30:00.000Z",
    high: 307.0400085449219,
    volume: 132387800,
    open: 290.2099914550781,
    low: 290,
    close: 298.260009765625,
    adjClose: 298.260009765625,
  },
  {
    date: "2025-05-12T13:30:00.000Z",
    high: 322.2099914550781,
    volume: 112826700,
    open: 321.989990234375,
    low: 311.5,
    close: 318.3800048828125,
    adjClose: 318.3800048828125,
  },
  {
    date: "2025-05-13T13:30:00.000Z",
    high: 337.5899963378906,
    volume: 136992600,
    open: 320,
    low: 316.79998779296875,
    close: 334.07000732421875,
    adjClose: 334.07000732421875,
  },
  {
    date: "2025-05-14T13:30:00.000Z",
    high: 350,
    volume: 136997300,
    open: 342.5,
    low: 337,
    close: 347.67999267578125,
    adjClose: 347.67999267578125,
  },
  {
    date: "2025-05-15T13:30:00.000Z",
    high: 346.1400146484375,
    volume: 97882600,
    open: 340.3399963378906,
    low: 334.7200012207031,
    close: 342.82000732421875,
    adjClose: 342.82000732421875,
  },
  {
    date: "2025-05-16T13:30:00.000Z",
    high: 351.6199951171875,
    volume: 95895700,
    open: 346.239990234375,
    low: 342.3299865722656,
    close: 349.9800109863281,
    adjClose: 349.9800109863281,
  },
  {
    date: "2025-05-19T13:30:00.000Z",
    high: 343,
    volume: 88869900,
    open: 336.29998779296875,
    low: 333.3699951171875,
    close: 342.0899963378906,
    adjClose: 342.0899963378906,
  },
  {
    date: "2025-05-20T13:30:00.000Z",
    high: 354.989990234375,
    volume: 131715500,
    open: 347.8699951171875,
    low: 341.6300048828125,
    close: 343.82000732421875,
    adjClose: 343.82000732421875,
  },
  {
    date: "2025-05-21T13:30:00.000Z",
    high: 347.3500061035156,
    volume: 102354800,
    open: 344.42999267578125,
    low: 332.20001220703125,
    close: 334.6199951171875,
    adjClose: 334.6199951171875,
  },
  {
    date: "2025-05-22T13:30:00.000Z",
    high: 347.2699890136719,
    volume: 97113400,
    open: 331.8999938964844,
    low: 331.3900146484375,
    close: 341.0400085449219,
    adjClose: 341.0400085449219,
  },
  {
    date: "2025-05-23T13:30:00.000Z",
    high: 343.17999267578125,
    volume: 84654800,
    open: 337.9200134277344,
    low: 333.2099914550781,
    close: 339.3399963378906,
    adjClose: 339.3399963378906,
  },
  {
    date: "2025-05-27T13:30:00.000Z",
    high: 363.7900085449219,
    volume: 120146400,
    open: 347.3500061035156,
    low: 347.32000732421875,
    close: 362.8900146484375,
    adjClose: 362.8900146484375,
  },
  {
    date: "2025-05-28T13:30:00.000Z",
    high: 365,
    volume: 91404300,
    open: 364.8399963378906,
    low: 355.9100036621094,
    close: 356.8999938964844,
    adjClose: 356.8999938964844,
  },
  {
    date: "2025-05-29T13:30:00.000Z",
    high: 367.7099914550781,
    volume: 88545700,
    open: 365.2900085449219,
    low: 356,
    close: 358.42999267578125,
    adjClose: 358.42999267578125,
  },
  {
    date: "2025-05-30T13:30:00.000Z",
    high: 363.67999267578125,
    volume: 123474900,
    open: 355.5199890136719,
    low: 345.2900085449219,
    close: 346.4599914550781,
    adjClose: 346.4599914550781,
  },
  {
    date: "2025-06-02T13:30:00.000Z",
    high: 348.0199890136719,
    volume: 81873800,
    open: 343.5,
    low: 333.3299865722656,
    close: 342.69000244140625,
    adjClose: 342.69000244140625,
  },
  {
    date: "2025-06-03T13:30:00.000Z",
    high: 355.3999938964844,
    volume: 99324500,
    open: 346.6000061035156,
    low: 343.0400085449219,
    close: 344.2699890136719,
    adjClose: 344.2699890136719,
  },
  {
    date: "2025-06-04T13:30:00.000Z",
    high: 345.6000061035156,
    volume: 98912100,
    open: 345.1000061035156,
    low: 327.3299865722656,
    close: 332.04998779296875,
    adjClose: 332.04998779296875,
  },
  {
    date: "2025-06-05T13:30:00.000Z",
    high: 324.54998779296875,
    volume: 287499800,
    open: 322.489990234375,
    low: 273.2099914550781,
    close: 284.70001220703125,
    adjClose: 284.70001220703125,
  },
  {
    date: "2025-06-06T13:30:00.000Z",
    high: 305.5,
    volume: 164747700,
    open: 298.8299865722656,
    low: 291.1400146484375,
    close: 295.1400146484375,
    adjClose: 295.1400146484375,
  },
  {
    date: "2025-06-09T13:30:00.000Z",
    high: 309.8299865722656,
    volume: 140908900,
    open: 285.9599914550781,
    low: 281.8500061035156,
    close: 308.5799865722656,
    adjClose: 308.5799865722656,
  },
  {
    date: "2025-06-10T13:30:00.000Z",
    high: 327.8299865722656,
    volume: 151256500,
    open: 314.94000244140625,
    low: 310.6700134277344,
    close: 326.0899963378906,
    adjClose: 326.0899963378906,
  },
  {
    date: "2025-06-11T13:30:00.000Z",
    high: 335.5,
    volume: 122611400,
    open: 334.3999938964844,
    low: 322.5,
    close: 326.42999267578125,
    adjClose: 326.42999267578125,
  },
  {
    date: "2025-06-12T13:30:00.000Z",
    high: 332.55999755859375,
    volume: 105127500,
    open: 323.0799865722656,
    low: 316.8599853515625,
    close: 319.1099853515625,
    adjClose: 319.1099853515625,
  },
  {
    date: "2025-06-13T13:30:00.000Z",
    high: 332.989990234375,
    volume: 128964300,
    open: 313.9700012207031,
    low: 313.29998779296875,
    close: 325.30999755859375,
    adjClose: 325.30999755859375,
  },
  {
    date: "2025-06-16T13:30:00.000Z",
    high: 332.04998779296875,
    volume: 83925900,
    open: 331.2900085449219,
    low: 326.4100036621094,
    close: 329.1300048828125,
    adjClose: 329.1300048828125,
  },
  {
    date: "2025-06-17T13:30:00.000Z",
    high: 327.260009765625,
    volume: 88282700,
    open: 326.0899963378906,
    low: 314.739990234375,
    close: 316.3500061035156,
    adjClose: 316.3500061035156,
  },
  {
    date: "2025-06-18T13:30:00.000Z",
    high: 329.32000732421875,
    volume: 95137700,
    open: 317.30999755859375,
    low: 315.45001220703125,
    close: 322.04998779296875,
    adjClose: 322.04998779296875,
  },
  {
    date: "2025-06-20T13:30:00.000Z",
    high: 332.3599853515625,
    volume: 108688000,
    open: 327.95001220703125,
    low: 317.7799987792969,
    close: 322.1600036621094,
    adjClose: 322.1600036621094,
  },
  {
    date: "2025-06-23T13:30:00.000Z",
    high: 357.5400085449219,
    volume: 190716800,
    open: 327.5400085449219,
    low: 327.4800109863281,
    close: 348.67999267578125,
    adjClose: 348.67999267578125,
  },
  {
    date: "2025-06-24T13:30:00.000Z",
    high: 356.260009765625,
    volume: 114736200,
    open: 356.1700134277344,
    low: 340.44000244140625,
    close: 340.4700012207031,
    adjClose: 340.4700012207031,
  },
  {
    date: "2025-06-25T13:30:00.000Z",
    high: 343,
    volume: 119845100,
    open: 342.70001220703125,
    low: 320.3999938964844,
    close: 327.54998779296875,
    adjClose: 327.54998779296875,
  },
  {
    date: "2025-06-26T13:30:00.000Z",
    high: 331.04998779296875,
    volume: 80440900,
    open: 324.6099853515625,
    low: 323.6099853515625,
    close: 325.7799987792969,
    adjClose: 325.7799987792969,
  },
  {
    date: "2025-06-27T13:30:00.000Z",
    high: 329.3399963378906,
    volume: 88826400,
    open: 324.510009765625,
    low: 317.5,
    close: 323.6300048828125,
    adjClose: 323.6300048828125,
  },
];


export async function GET(req: Request) {
  const { searchParams } = new URL(req.url);
  const stock = searchParams.get("stock");
  const dateValue = searchParams.get("dateValue");

  if (!stock || !dateValue) {
    return NextResponse.json({ error: "Missing parameters" }, { status: 400 });
  }

  const query = stock as string;
  const dayValue = moment(dateValue).subtract(90, "days").format("YYYY-MM-DD");

  const queryOptions = { period1: dayValue/* ... */ };
  
  try {
    // const result = await yahooFinance.historical(query, queryOptions);

    return NextResponse.json(result);
  } catch (error) {
    console.error(error);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}
